<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>그림판</title>
    <style type="text/css">
        canvas {
            border: 1px solid black
        }

        ;
    </style>
    <script type="text/javascript">
        window.onload = function () {
            var canvas = document.getElementById("canvas");
            draw(canvas);

        }

        function draw(canvas) {
            var ctx = canvas.getContext("2d");
            ctx.moveTo(30, 100);
            ctx.lineTo(80, 100);
            ctx.stroke();
        }


        var pos = { //기준점
            drawable: false,
            x: -1,
            y: -1
        };

        var canvas, ctx;

        window.onload = function () {
            canvas = document.getElementById("canvas"); //canvas 이용
            ctx = canvas.getContext("2d"); //2d그림으로 그리겠다.

            canvas.addEventListener("mousedown", listener); //mousedown 이벤트가 발생하면 listener 함수 실행
            canvas.addEventListener("mousemove", listener);
            canvas.addEventListener("mouseup", listener);
            canvas.addEventListener("mouseout", listener);
        }

        function listener(event) {
            switch (event.type) {
                case "mousedown":
                    initDraw(event); //클릭했을 때 버튼을 누르면 mousedown 이벤트가 발생하고, moveTo()를 이용해서 해당 좌표로 pos 이동
                    break;

                case "mousemove":
                    if (pos.drawable)
                        draw(event); //down 상태에서 이동을 하면 move이벤트가 발생, lineTo()를 이용해서 라인을 그리기
                    break;

                case "mouseout":
                case "mouseup":
                    finishDraw(); //마우스가 캔버스에서 벗어나면 out이벤트를, 마우스에서 손가락을 떼면 up이벤트 발생하여 그리기 중지
                    break;
            }
        }

        function initDraw(event) { //시작점
            ctx.beginPath();
            pos.drawable = true;
            var coors = getPosition(event);
            pos.x = coors.x;
            pod.y = coors.y;
            ctx.moveTo(pos.x, pos.y);


        }

        function draw(event) { //그리기
            var coors = getPosition(event);
            ctx.lineTo(coors.x, coors.y);
            pos.x = coors.x;
            pos.y = coors.y;
            ctx.stroke();
        }

        function finishDraw(event) {
            pos.drawable = false;
            pos.x = -1;
            pos.y = -1;
        }

        function getPosition(event) {
            var X = event.pageX - canvas.offsetLeft;
            var Y = event.pageY - canvas.offsetTop;
            return { x: X, y: Y };
        }


    </script>
</head>

<body>
    <div>
        <canvas id="canvas" width="500" height="500"></canvas>
    </div>
</body>

</html>