<!-- https://data.go.kr/data/15057411/openapi.do -->
<!-- https://developers.google.com/chart/interactive/docs/gallery/piechart?hl=ko -->

<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript">

        $(function () {
            let publicAPI = "https://8oi9s0nnth.apigw.ntruss.com/corona19-masks/v1/storesByAddr/json?";
            let data2 = { address: "�꽌�슱�듅蹂꾩떆 媛뺣궓援�" };
            var plenty = 0;
            var some = 0;
            var few = 0;
            var empty = 0;
            var stop = 0;

            $.getJSON(publicAPI, data2, function (data2) {
                console.log(data2.stores.length);
                for (var i = 0; i < data2.stores.length; i++) {
                    $.each(data2.stores[i], function (index, obj) { //index�뒗 �궎, obj�뒗 value
                        //console.log("媛믪씠�떎!! : " + obj + " /// �궎�떎: " + index);

                        if (obj === null) {
                            return;
                        } else {
                            if (index.includes("remain_stat")) {
                                if (obj.includes("plenty")) {
                                    plenty += 1;
                                } else if (obj.includes("some")) {
                                    some += 1;
                                } else if (obj.includes("few")) {
                                    few += 1;
                                } else if (obj.includes("empty")) {
                                    empty += 1;
                                } else if (obj.includes("break")) {
                                    stop += 1;
                                }
                            }
                        }
                    }); //each(end)
                    //console.log(plenty);

                } //for(end)
                temp1 = plenty;
                console.log();
                $('<div>').attr('id', 'plenty').attr('value', plenty).appendTo("#kwc");
                $('<div>').attr('id', 'some').attr('value', some).appendTo("#kwc");
                $('<div>').attr('id', 'few').attr('value', few).appendTo("#kwc");
                $('<div>').attr('id', 'empty').attr('value', empty).appendTo("#kwc");
                $('<div>').attr('id', 'stop').attr('value', stop).appendTo("#kwc");
                console.log("�빞湲곕㉫��?")
                google.charts.load('current', { 'packages': ['corechart'] });
                google.charts.setOnLoadCallback(drawChart);
            }); //$.getJSON (end)

       
            function drawChart() {
                var xs = document.getElementById('plenty')
                var xs2 = document.getElementById('some')
                var xs3 = document.getElementById('few')
                var xs4 = document.getElementById('empty')
                var xs5 = document.getElementById('stop')
                // console.log(xs);
                // console.log(xs.innerHTML);
                console.log(xs.getAttribute("value"));
                console.log(xs2.getAttribute("value"));
                console.log(xs3.getAttribute("value"));
                console.log(xs4.getAttribute("value"));
                console.log(xs5.getAttribute("value"));
                Number(xs.getAttribute("value"))
                var data = google.visualization.arrayToDataTable([
                    ['Task', 'Hours per Day'],
                    ['plenty', Number(xs.getAttribute("value"))],
                    ['some', Number(xs2.getAttribute("value"))],
                    ['few', Number(xs3.getAttribute("value"))],
                    ['empty',Number(xs4.getAttribute("value"))],
                    ['stop', Number(xs5.getAttribute("value"))]
                ]);

                var options = {
                    title: 'My Daily Activities'
                };

                var chart = new google.visualization.PieChart(document.getElementById('piechart'));

                chart.draw(data, options);
            }

        });
    </script>

</head>

<body>
    <div id="piechart" style="width: 900px; height: 500px;"></div>
    <div id="kwc"></div>

</body>


</html>